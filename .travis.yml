# WARNING: DO NOT EDIT!
#
# This file was generated by plugin_template, and is managed by bootstrap.py. Please use
# bootstrap.py to update this file.
#
# For more info visit https://github.com/pulp/plugin_template
---
sudo: required
# https://docs.travis-ci.com/user/trusty-ci-environment/
dist: bionic
language: python
python:
  # Fedora has 3.6 available (python36.x86_64), but pulp container images
  # with it are not being built or published yet.
  # - "3.6"
  - "3.7"
env:
  matrix:
    - TEST=pulp
services:
  - postgresql
  - redis-server
  - docker
addons:
  apt:
    packages:
      - httpie
      - jq
  # postgres versions provided by el7 RHSCL (lowest supportable version)
  postgresql: '9.6'
before_install: .travis/before_install.sh
install: .travis/install.sh
before_script: .travis/before_script.sh
script: .travis/script.sh
after_failure:
  - http --timeout 30 --check-status --pretty format --print hb http://localhost:24817/pulp/api/v3/status/
  - sudo docker images
  - sudo kubectl logs -l name=pulp-operator -c ansible --tail=10000
  - sudo kubectl logs -l name=pulp-operator -c operator --tail=10000
  - sudo kubectl logs -l app=pulp-api --tail=50000
  - sudo kubectl logs -l app=pulp-content --tail=10000
  - sudo kubectl logs -l app=pulp-resource-manager --tail=10000
  - sudo kubectl logs -l app=pulp-worker --tail=10000
jobs:
  include:
  - stage: Release to PyPI
    if: tag IS NOT blank
    deploy:
      provider: pypi
      server: https://test.pypi.org/legacy/
      user: "__token__"
      password:
        secure: f2B1zw+pyieLUyHYXVP4TCTcmIBdThtUHnNH1Iio1I6xiFW3M+1lJr5DgK9XMQxZObkcvQ/HsDqp92czUjmqUzVZaN1jMyUQC0Cw56Qpy5jwJja62f3Sy2tPBs2PsOyYZ6LqQQqgSd3O1YfLlpykWqvNTRBvnMmyvSo/S2jPQv3z0BX6en3oKHpvVvSQjKBWOVyhe+wlJ+jL3lmmNwGXbee4Fri+pmdcQE3YmBzPaaxXAPoHpIZxWKQOmP7WYDSnuKtcMdT5CfPd57nkNl+kw6Et/DBCiGRSPPNVycPqgUjevl68BXA5+osJcKf0twoXXCnWV0nMQ5KTxhV8UF95OTs2wcj4595dNL+2FMntO3T47KBy1PcbqP7XfDrHLQC44dTISv+/FGbkbQmYwP+00j8jTADMlAXDT0WQmhRc8JsTLcOpnlu5h+rZykS6+HbeimIy2zsV5xdylai1RrsFHyAvb+RghkWKQPvj5fBajIA8vEC43kQuEbNyVpgfTxWx3bmchJXk8sWciU908Me7FHn/WLjLs0frEe03WJcu4KBoinUHSFMhSDFm74ypyUgQJRdlzx4Ji3yY/sPfQpOyCUbotuk6J99oLVlh2qJ0spslnwaBqxIWMEe4Zawd27PFcWmnU6yuMkCEtgkU4V7NTUNwSTX5yvYH4Gdn0R6CSVo=
      on:
        tags: true
...
